<ion-card class="quiz-card" *ngIf="currentQuestion() as q">
  <ion-card-header>
    <ion-card-title>{{ title }}</ion-card-title>
    <ion-card-subtitle>{{ progressLabel() }}</ion-card-subtitle>
  </ion-card-header>
  <ion-card-content>
    <div class="quiz-item">
      <div class="quiz-head">
        <span class="pill light">{{ q.difficulty }}</span>
      </div>
      <p class="question">{{ q.question }}</p>
      <ion-list lines="none">
        <ion-item
          *ngFor="let c of q.choices"
          (click)="select(q, c.id)"
          [disabled]="!!answers[q.id]?.choice"
          [class.correct]="choiceState(q, c.id) === 'correct'"
          [class.wrong]="choiceState(q, c.id) === 'wrong'"
          [class.selected]="choiceState(q, c.id) === 'selected'"
          button
        >
          <ion-label>{{ c.text }}</ion-label>
        </ion-item>
      </ion-list>

      <div class="instant-feedback" *ngIf="answers[q.id] as a" [class.correct]="a.correct" [class.wrong]="!a.correct">
        <strong>{{ a.correct ? 'Richtig' : 'Falsch' }}</strong>
        <p>{{ q.explain }}</p>
      </div>
    </div>
    <div class="nav-row">
      <ion-button size="small" fill="outline" (click)="prev()" [disabled]="currentIndex === 0">Zurueck</ion-button>
      <ion-button size="small" fill="outline" (click)="next()" [disabled]="currentIndex >= active.length - 1">Weiter</ion-button>
      <div class="spacer"></div>
      <ion-chip color="primary" outline="true">{{ answeredCount() }}/{{ active.length }} beantwortet</ion-chip>
    </div>

    <div class="result" *ngIf="finishedSummary">
      <p>Ergebnis: {{ finishedSummary.correct }} / {{ finishedSummary.total }} richtig</p>
      <ion-button size="small" fill="outline" color="medium" (click)="reset()">Neue Runde</ion-button>
      <ion-button size="small" fill="clear" (click)="toggleSolutions()">
        {{ showSolutions ? 'Loesungen ausblenden' : 'Loesungen zeigen' }}
      </ion-button>
    </div>
  </ion-card-content>
</ion-card>
